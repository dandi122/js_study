package com.example.demo.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import com.example.demo.dto.SalesGroupBy;
import com.example.demo.repository.SalesRepository;
import com.example.demo.service.SalesService;

import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;

// 향후 react, vue 에서 접근시 crossdomain 문제를 해결하기 위해 임시 처리
@CrossOrigin()
@RequestMapping("/api")
@Controller
public class ApiController {
	//1. 서비스 di
	@Autowired
	private SalesService salesService;
	
	
	//2. SALES 관련 집계 데이터를 응답하는 API를 제공하는 라우터, 메소드 구성
	//  ~/api/sales, GET방식, swagger를 이용한 테스트
	@GetMapping("/sales")
	@Tag(name="세일 데이터 집계", description="세일 데이터 집계")
	@Operation(summary="카테고리 개수에 맞춰 집계한 평균 판매가, 평균개수 조회", description="카테고리 개수에 맞춰 집계한 평균 판매가, 평균개수 조회")
	public List<SalesGroupBy> sales() {
		return salesService.getSalesGroupBy();
	}
}
